(self.webpackChunkfreya_admin=self.webpackChunkfreya_admin||[]).push([[531],{16964:function(W){W.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",icon:"icon___rzGKO"}},1346:function(){},70077:function(W,Y,e){"use strict";e.r(Y),e.d(Y,{default:function(){return Be}});var Ee=e(28579),K=e(11871),be=e(71838),V=e(99128),p=e(36531),L=e(66940),O=e(28211),Ie=e(54113),ae=e(41637),te=e(70486),d=e.n(te),a=e(59301),re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},se=re,k=e(23986),J=function(n,l){return a.createElement(k.Z,(0,p.Z)((0,p.Z)({},n),{},{ref:l,icon:se}))};J.displayName="LockOutlined";var Q=a.forwardRef(J),ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M744 62H280c-35.3 0-64 28.7-64 64v768c0 35.3 28.7 64 64 64h464c35.3 0 64-28.7 64-64V126c0-35.3-28.7-64-64-64zm-8 824H288V134h448v752zM472 784a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"mobile",theme:"outlined"},le=ne,X=function(n,l){return a.createElement(k.Z,(0,p.Z)((0,p.Z)({},n),{},{ref:l,icon:le}))};X.displayName="MobileOutlined";var ue=a.forwardRef(X),ie=e(69879),z=e(10322),Oe=e(99793),oe=e(20658),R=e(20557),ce=e(82381),de=e(95443),ze=e(1346),fe=["logo","message","title","subTitle","actions","children"];function me(s){var n=s.logo,l=s.message,f=s.title,o=s.subTitle,E=s.actions,b=s.children,C=(0,R.Z)(s,fe),T=(0,de.YB)(),B=(0,p.Z)({searchConfig:{submitText:T.getMessage("loginForm.submitText","\u767B\u5F55")},render:function(I,m){return m.pop()},submitButtonProps:{size:"large",style:{width:"100%"}}},C.submitter),D=(0,a.useContext)(oe.ZP.ConfigContext),F=D.getPrefixCls("pro-form-login"),P=function(I){return"".concat(F,"-").concat(I)},S=(0,a.useMemo)(function(){return n?typeof n=="string"?a.createElement("img",{src:n}):n:null},[n]);return a.createElement("div",{className:P("container")},a.createElement("div",{className:P("top")},f||S?a.createElement("div",{className:P("header")},S?a.createElement("span",{className:P("logo")},S):null,f?a.createElement("span",{className:P("title")},f):null):null,o?a.createElement("div",{className:P("desc")},o):null),a.createElement("div",{className:P("main")},a.createElement(ce.Z,(0,z.Z)({isKeyPressSubmit:!0,submitter:B},C),l,b),E?a.createElement("div",{className:P("other")},E):null))}var ge=me,q=e(20248),ve=["fieldProps","proFieldProps"],pe=["fieldProps","proFieldProps"],$="text",he=function(n){var l=n.fieldProps,f=n.proFieldProps,o=(0,R.Z)(n,ve);return a.createElement(q.Z,(0,z.Z)({mode:"edit",valueType:$,fieldProps:l,filedConfig:{valueType:$},proFieldProps:f},o))},Fe=function(n){var l=n.fieldProps,f=n.proFieldProps,o=(0,R.Z)(n,pe);return a.createElement(q.Z,(0,z.Z)({mode:"edit",valueType:"password",fieldProps:l,proFieldProps:f,filedConfig:{valueType:$}},o))},w=he;w.Password=Fe,w.displayName="ProFormComponent";var A=w,De=e(41505),ye=e(79538),He=e(40279),Ze=e(88591),Re=e(58408),Pe=e(36838),xe=e(11557),Me=["rules","name","phoneName","fieldProps","captchaTextRender","captchaProps"],Ce=a.forwardRef(function(s,n){var l=(0,a.useState)(s.countDown||60),f=(0,O.Z)(l,2),o=f[0],E=f[1],b=(0,a.useState)(!1),C=(0,O.Z)(b,2),T=C[0],B=C[1],D=(0,a.useState)(),F=(0,O.Z)(D,2),P=F[0],S=F[1],H=s.rules,I=s.name,m=s.phoneName,u=s.fieldProps,g=s.captchaTextRender,x=g===void 0?function(c,M){return c?"".concat(M," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:g,i=s.captchaProps,y=(0,R.Z)(s,Me),Z=function(){var c=(0,L.Z)(d().mark(function M(j){return d().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,S(!0),r.next=4,y.onGetCaptcha(j);case 4:S(!1),B(!0),r.next=13;break;case 8:r.prev=8,r.t0=r.catch(0),B(!1),S(!1),console.log(r.t0);case 13:case"end":return r.stop()}},M,null,[[0,8]])}));return function(j){return c.apply(this,arguments)}}();return(0,a.useEffect)(function(){var c=0,M=s.countDown;return T&&(c=window.setInterval(function(){E(function(j){return j<=1?(B(!1),clearInterval(c),M||60):j-1})},1e3)),function(){return clearInterval(c)}},[T]),a.createElement(ye.Z.Item,{noStyle:!0,shouldUpdate:!0},function(c){var M=c.getFieldValue,j=c.validateFields;return a.createElement("div",{style:(0,p.Z)((0,p.Z)({},u==null?void 0:u.style),{},{display:"flex",alignItems:"center"}),ref:n},a.createElement(Pe.Z,(0,z.Z)({},u,{style:{flex:1,transition:"width .3s",marginRight:8}})),a.createElement(Ze.Z,(0,z.Z)({style:{display:"block"},disabled:T,loading:P},i,{onClick:(0,L.Z)(d().mark(function U(){var r;return d().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(v.prev=0,!m){v.next=9;break}return v.next=4,j([m].flat(1));case 4:return r=M([m].flat(1)),v.next=7,Z(r);case 7:v.next=11;break;case 9:return v.next=11,Z("");case 11:v.next=16;break;case 13:v.prev=13,v.t0=v.catch(0),console.log(v.t0);case 16:case"end":return v.stop()}},U,null,[[0,13]])}))}),x(T,o)))})}),je=(0,xe.Z)(Ce),h=e(78449),Se=e(89182),_=e(45103);function Te(s,n){return G.apply(this,arguments)}function G(){return G=(0,L.Z)(d().mark(function s(n,l){return d().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,h.WY)("/api/login/captcha",(0,p.Z)({method:"GET",params:(0,p.Z)({},n)},l||{})));case 1:case"end":return o.stop()}},s)})),G.apply(this,arguments)}var Le=e(16964),N=e.n(Le),t=e(37712),ee=function(n){var l=n.content;return(0,t.jsx)(ae.Z,{style:{marginBottom:24},message:l,type:"error",showIcon:!0})},Ne=function(){var n=(0,a.useState)({}),l=(0,O.Z)(n,2),f=l[0],o=l[1],E=(0,a.useState)("account"),b=(0,O.Z)(E,2),C=b[0],T=b[1],B=(0,h.tT)("@@initialState"),D=B.setInitialState,F=(0,h.YB)(),P=function(){var m=(0,L.Z)(d().mark(function u(){var g,x,i;return d().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,(0,_.CW)({token:localStorage.getItem("token")||""});case 2:if(g=Z.sent,x=g.data.user,i={name:x.name,avatar:"http://cdnoss.stardustgod.com/chapters_test/special_effects/202202/6214a1492b085.jpg"},localStorage.setItem("userinfo",JSON.stringify(i)),!i){Z.next=9;break}return Z.next=9,D(function(c){return(0,p.Z)((0,p.Z)({},c),{},{currentUser:i})});case 9:case"end":return Z.stop()}},u)}));return function(){return m.apply(this,arguments)}}(),S=function(){var m=(0,L.Z)(d().mark(function u(g){var x,i,y,Z,c,M,j;return d().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,_.wm)((0,p.Z)((0,p.Z)({},g),{},{type:C}));case 3:if(i=r.sent,localStorage.setItem("token",(x=i.data)===null||x===void 0?void 0:x.token),i.msg!=="\u767B\u5F55\u6210\u529F"){r.next=16;break}return y=F.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),V.default.success(y),r.next=10,P();case 10:if(h.m8){r.next=12;break}return r.abrupt("return");case 12:return Z=h.m8.location.query,c=Z,M=c.redirect,h.m8.push(M||"/"),r.abrupt("return");case 16:o(i),r.next=23;break;case 19:r.prev=19,r.t0=r.catch(0),j=F.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),V.default.error(j);case 23:case"end":return r.stop()}},u,null,[[0,19]])}));return function(g){return m.apply(this,arguments)}}(),H=f.status,I=f.type;return(0,t.jsxs)("div",{className:N().container,children:[(0,t.jsx)("div",{className:N().lang,"data-lang":!0,children:h.pD&&(0,t.jsx)(h.pD,{})}),(0,t.jsx)("div",{className:N().content,children:(0,t.jsxs)(ge,{title:"Freya Admin",initialValues:{autoLogin:!0},onFinish:function(){var m=(0,L.Z)(d().mark(function u(g){return d().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,S(g);case 2:case"end":return i.stop()}},u)}));return function(u){return m.apply(this,arguments)}}(),children:[(0,t.jsx)(K.Z,{activeKey:C,onChange:T,children:(0,t.jsx)(K.Z.TabPane,{tab:F.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},"account")}),H==="error"&&I==="account"&&(0,t.jsx)(ee,{content:F.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),C==="account"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A,{name:"telephone",fieldProps:{size:"large",prefix:(0,t.jsx)(ie.Z,{className:N().prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",rules:[{required:!0,message:(0,t.jsx)(h._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,t.jsx)(A.Password,{name:"password",fieldProps:{size:"large",prefix:(0,t.jsx)(Q,{className:N().prefixIcon})},placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!0,message:(0,t.jsx)(h._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),H==="error"&&I==="mobile"&&(0,t.jsx)(ee,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),C==="mobile"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A,{fieldProps:{size:"large",prefix:(0,t.jsx)(ue,{className:N().prefixIcon})},name:"mobile",placeholder:F.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,t.jsx)(h._H,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,t.jsx)(h._H,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,t.jsx)(je,{fieldProps:{size:"large",prefix:(0,t.jsx)(Q,{className:N().prefixIcon})},captchaProps:{size:"large"},placeholder:F.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(u,g){return u?"".concat(g," ").concat(F.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):F.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,t.jsx)(h._H,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var m=(0,L.Z)(d().mark(function u(g){var x;return d().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,Te({phone:g});case 2:if(x=y.sent,x!==!1){y.next=5;break}return y.abrupt("return");case 5:V.default.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return y.stop()}},u)}));return function(u){return m.apply(this,arguments)}}()})]}),(0,t.jsx)("div",{style:{marginBottom:24}})]})}),(0,t.jsx)(Se.Z,{})]})},Be=Ne}}]);
